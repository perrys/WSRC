{% extends "base.html" %}
{% block pagetitle %}Home{% endblock %}
{% block pagetype %}home{% endblock %}
{% block header_extra %}
{{ block.super }}
<script>
window.WSRC_today_bookings = [
{% for row in bookings %}
{% if forloop.counter0 > 0 %},{% endif %}
{ start_time: "{{ row.start_time|date:'c' }}", end_time: "{{ row.end_time|date:'c' }}", description: "{{ row.description }}", court: {{ row.court }} }
{% endfor %}
]
</script>
{% endblock %}
{% block content %}

<div role="main" class="ui-content jqm-content">
  <div id="main_div"> 

  {{ pagedata.content|safe }}

  <div class="ui-grid-a ui-responsive">
    <div class="ui-block-a">
      <div class="jqm-block-content">
        <h3>News</h3>
        <div class="restricted">
          <table id="facebook_news">
            <tbody>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    <div class="ui-block-b">
      <div class="jqm-block-content toggle-root">
        <h3>Courts</h3>
        <div class="headed-box restricted-with-footnote">
          <div class="ui-bar ui-bar-a" data-role="header" data-position="inline">
            <h4>Today</h4>
            <a id="btn_booking_previous" href="javascript:WSRC.booking_advance(-1);" class="ui-btn ui-icon-arrow-l ui-btn-icon-notext ui-corner-all ui-btn-left">
            </a>
            <a id="btn_booking_next" href="javascript:WSRC.booking_advance(1);" class="ui-btn ui-icon-arrow-r ui-btn-icon-notext ui-corner-all ui-btn-right">
            </a>
          </div>
          <div class="ui-body">
            <table id="evening_bookings" data-basedate="{{ today }}" data-dayoffset="0">
              <tbody>
              </tbody>
            </table>
          </div>
        </div>
        <div class="footnote togglable toggle-link" id="booking_seeall_toggle"><a href="#">(see all)</a></div>
        <div class="footnote toggled toggle-link"><a href="#">(evenings)</a></div>
      </div>
    </div>
    <div class="ui-block-a">
      <div class="jqm-block-content toggle-root">
        <h3>Results</h3>
        <div class="restricted-with-footnote">
          <table>
{% for row in leaguemaster %}
<tr class="{% cycle 'odd' 'even' %} {% if forloop.counter0 < leaguemaster_recent_min_idx or forloop.counter0 > leaguemaster_recent_max_idx %}toggled{% endif %}">
<td class='nobreak'>{% if row.url %}<a href='http://county.leaguemaster.co.uk/{{ row.url }}'>{% endif %}{{ row.date|date:"d M" }}{% if row.url %}</a>{% endif %}</td>
<td class='nobreak'>{{ row.team }} ({{ row.home_or_away }})</td>
<td>{{ row.opponents }}</td>
<td class="nobreak {{ row.class }}{% if not row.points %} empty{% endif %}">{% if row.points %}{{ row.scores|safe }} ({{ row.points|safe }}){% endif %}</td></tr>
{% endfor %}
          </table>
        </div>
        <div class="footnote togglable toggle-link"><a href="#">(see all)</a></div>
        <div class="footnote toggled toggle-link"><a href="#">(recent)</a></div>
      </div>
    </div>
    <div class="ui-block-b">
      <div class="jqm-block-content toggle-root">
        <h3>SquashLevels</h3>
        <div class="restricted-with-footnote">
          <table>
{% for row in squashlevels %}
<tr class="{% cycle 'odd' 'even' %} {% if forloop.counter > 10 %}toggled{% endif %}"><td>{% if row.player.squashlevels_id %}<a href='http://www.squashlevels.com/player_detail.php?player={{ row.player.squashlevels_id }}&show=last12m'>{{ row.name }}</a>{% else %}{{ row.name }}{% endif %}</td><td class='nobreak'>{{ row.last_match_date|date:'d M' }}</td><td>{{ row.level }}</td></tr>
{% endfor %}
          </table>
        </div>
        <div class="footnote togglable toggle-link"><a href="#">(see all)</a></div>
        <div class="footnote toggled toggle-link"><a href="#">(top 10)</a></div>
      </div>
    </div>        	
  </div>
  </div>
</div>

<script>
$( document ).on( "pagecontainershow", ".wsrc-site", function( event ) {
  var last = document.getElementById("leaguemaster_{{ leaguemaster_last_result_idx|add:'-5' }}");
  if (last != null && last.scrollIntoView != undefined)
    last.scrollIntoView();
  WSRC.onIndexPageShow();
})
</script>

{% endblock %}

