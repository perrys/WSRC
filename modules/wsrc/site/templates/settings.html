{% extends "base.html" %}
{% block pagetitle %}Settings{% endblock %}
{% load kwacros %}
{% loadkwacros 'form_macros.html' %}
{% block centered_page_content %}

<form id="settings_form" method="post" action="{% url 'wsrc.site.views.settings_view' %}" data-ajax="false" class="settings-form">
{% csrf_token %}

{% if form_saved %}
<span class="form_success_message">Settings saved.</span>
{% endif %}

{% if user_form.errors or player_form.errors or evt_filter_form.errors %}
<span class="form_error_message ui-btn-icon ui-btn-icon-left ui-icon-alert">Validation Error. Please correct the problem(s) below and resubmit.</span>

{% for err in user_form.non_field_errors %}
  <div class="form_error_message">{{ err }}</div>
{% endfor %}

{% for err in player_form.non_field_errors %}
  <div class="form_error_message">{{ err }}</div>
{% endfor %}

{% for err in evt_filter_form.non_field_errors %}
  <div class="form_error_message">{{ err }}</div>
{% endfor %}

{% endif %}

<input type="hidden" name="next" value="{% url 'wsrc.site.views.settings_view' %}" />
<fieldset name="login_details">
<legend>Login</legend>
{% usekwacro createfield user_form.username %}
<div class="ui-field-contain">
 <label>Password:</label>
 <label><input id="id_password" type="checkbox" checked="checked" onclick="document.location='{% url 'password_change' %}'; this.checked=true; return false;"> Set (click to change)</label>
</div>
</fieldset>

<fieldset name="personal_details">
<legend>Personal Details</legend>
{% usekwacro createfield user_form.first_name %}
{% usekwacro createfield user_form.last_name %}
{% usekwacro createfield player_form.short_name %}
</fieldset>

<fieldset name="contact_details">
<legend>Contact Details</legend>
{% usekwacro createfield user_form.email %}
{% usekwacro createfield player_form.cell_phone %}
{% usekwacro createfield player_form.other_phone %}
{% usekwacro createfield player_form.prefs_receive_email %}
</fieldset>

<fieldset name="court_booking" class="toggle-root" >
<legend>Court Booking</legend>
<div class="ui-field-contain">
  <label for="notifier_active">Cancel Notifier:</label>
  <select name="notifier_active" id="notifier_active" onchange="wsrc.settings.on('toggle_notifier_inputs')">
    <option value="off">Off</option>
    <option value="on" {% if notifier_active %}selected="selected"{% endif %}>On</option>
  </select>
</div>
<div id="court_notifier_inputs" {% if notifier_active %}class="toggleable"{% else %}class="toggled"{% endif %}>
{% usekwacro createfield evt_filter_form.earliest %}
{% usekwacro createfield evt_filter_form.latest %}
{% usekwacro createradiofield evt_filter_form.days %}
{% usekwacro createfield evt_filter_form.notice_period_minutes %}
</div>

</fieldset>

<fieldset name="information">
<legend>Information</legend>
{% usekwacro createfield info_form.membership_type %}
{% usekwacro createfield info_form.membership_id %}
{% usekwacro createfield info_form.squashlevels_id %}
</fieldset>

<input id="submit_button" type="submit" value="Update" data-theme="b" />

</form>

<script>
  wsrc.settings.onReady(null)
</script>

{% endblock %}
