{% extends "header_base.html" %}

{% block header_extra %}
<script>
$( document ).on( "pagecreate", ".wsrc-site", function( event ) {
  var page = $( this );
  $( ".jqm-navmenu-panel ul" ).listview();
  $( ".jqm-navmenu-link" ).on( "click", function() {
    var panel = page.find( ".jqm-navmenu-panel:not(.jqm-panel-page-nav)" ).panel();
    panel.panel( "open" );
  });
});
</script>
{% endblock %}

{% block body %}
<div id="outer_page_div" data-role="page" data-pagetype="{% block pagetype %}{% endblock %}" {% block pageattrs %}{% endblock %} class="wsrc-site">

  <div data-role="header" class="jqm-header">
    <h2><a href="/home"><img src="/static/images/WSRC-banner.jpg" alt="Woking Squash Club"></a></h2>
    <p>{% block pagetitle %}{% endblock %}</p>
    <a href="#" class="jqm-navmenu-link ui-btn ui-btn-icon-notext ui-corner-all ui-icon-bars ui-nodisc-icon ui-alt-icon ui-btn-left">Menu</a>
    <div class="wsrc-login-block">
    <a href="{% if user.is_authenticated %}#logout_dialog{% else %}/login?next={{ request.get_full_path }}{% endif %}" class="wsrc-login-icon ui-btn ui-btn-icon-notext ui-corner-all ui-icon-user ui-nodisc-icon ui-alt-icon" {% if user.is_authenticated %}data-transition="pop"{% else %}data-ajax="false"{% endif %}>Login</a>
    <a href="{% if user.is_authenticated %}#logout_dialog{% else %}/login?next={{ request.get_full_path }}{% endif %}" class="wsrc-login-textlink" {% if user.is_authenticated %}data-transition="pop"{% else %}data-ajax="false"{% endif %}>{% if user.is_authenticated %}{{ user.first_name }}{% else %}Login{% endif %}</a>
    </div>
  </div>

    {% block content %}{% endblock %}

  <!-- left nav menu: -->
  <div data-role="panel" class="jqm-navmenu-panel" data-position="left" data-display="overlay" data-theme="a">
    <ul class="jqm-list ui-alt-icon ui-nodisc-icon">

      <li data-icon="home"><a href="{% url 'homepage' %}" data-ajax="false">Home</a></li>

      <li data-icon="info"><a href="/about">About</a></li>
      <li><a href="/membership">Membership</a></li>
      <li><a href="/coaching">Coaching</a></li>
      <li><a href="/juniors">Juniors</a></li>

      <li><a href="{% url 'boxes' %}"   data-ajax="false">Club Leagues</a></li>
      <li><a href="{% url 'tournaments' %}" data-ajax="false">Club Tournaments</a></li>

{% if user.is_authenticated %}
      <li data-icon="calendar"><a href="http://court-booking.co.uk/WokingSquashClub/" data-ajax="false">Court Booking</a></li>
      <li data-icon="phone"><a href="{% url 'member_list' %}">Members' Details</a></li>
      <li data-icon="gear"><a href="{% url 'settings' %}">Settings</a></li>
      <li data-icon="qmark"><a href="/help">Help</a></li>
{% endif %}

      <li data-icon="star"><a href="/links">Links and Credits</a></li>
      <li data-icon="mail"><a href="/contact">Contact Us</a></li>
    </ul>
  </div>

  <div data-role="footer" data-position="fixed" data-tap-toggle="false" class="jqm-footer">
    <div>Woking Squash Rackets Club</div>
    <div class="last_updated">{% block last_updated %}{% endblock %}</div>
  </div>

  <div data-role="popup" id="errorPopupDialog" data-overlay-theme="b" data-theme="b" data-dismissible="false" style="max-width:400px;">
    <div data-role="header" data-theme="a">
      <h1>Error</h1>
    </div>
    <div class="ui-content">
      <h3 class="ui-title">__ERROR__</h3> <!-- to be replaced be real error message -->
      <a href="#" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b" data-rel="back" data-transition="flow">Ok</a>
    </div>
  </div>

</div><!-- /page -->

{% if user.is_authenticated %}
<div data-role="page" data-dialog="true" data-position-to="window" id="logout_dialog" data-dismissible="false">
  <div data-role="header" data-theme="a">
    <h1>{{ user.first_name }} {{ user.last_name }}</h1>
  </div>
  <div class="ui-content">
    <h3 class="ui-title">What would you like to do?</h3>
    <a href="{% url 'settings' %}" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b">Settings</a>
    <a href="{% url 'logout' %}?next=/home" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b" data-ajax="false">Logout</a>
    <a style="float: right;" href="#" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b" data-rel="back" data-transition="flow">Cancel</a>
  </div>
</div>
{% endif %}
  
{% endblock %}
